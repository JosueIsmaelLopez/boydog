<html>
	<head>
		<title>A Simple HTML Document</title>
		<link rel="stylesheet" href="/milligram.css">
		<script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
	</head>
	<body>
		<div class="container">
		  <div class="row">
			<div class="column">
				<form>
				  <fieldset>
					<input type="text" placeholder="name" dog-link="users[1].name">
					<input type="text" placeholder="age" dog-link="users[1].age">
					<input type="text" placeholder="email" dog-link="users[1].email">
					
					
					<label for="ageRangeField">Age Range</label>
					<select id="ageRangeField">
					  <option value="0-13">0-13</option>
					  <option value="14-17">14-17</option>
					  <option value="18-23">18-23</option>
					  <option value="24+">24+</option>
					</select>
					<label for="commentField">Comment</label>
					<textarea placeholder="Hi CJ â€¦" id="commentField"></textarea>
					<div class="float-right">
					  <input type="checkbox" id="confirmField">
					  <label class="label-inline" for="confirmField">Send a copy to yourself</label>
					</div>
					<input class="button-primary" type="submit" value="Send">
				  </fieldset>
				</form>
			</div>
			<div class="column">
				<table>
				  <thead>
					<tr>
					  <th>Name</th>
					  <th>Age</th>
					  <th>Height</th>
					  <th>Location</th>
					</tr>
				  </thead>
				  <tbody>
					<tr>
					  <td>Stephen Curry</td>
					  <td>27</td>
					  <td>1,91</td>
					  <td>Akron, OH</td>
					</tr>
					<tr>
					  <td>Klay Thompson</td>
					  <td>25</td>
					  <td>2,01</td>
					  <td>Los Angeles, CA</td>
					</tr>
				  </tbody>
				</table>
				<a class="button" href="#">Default Button</a>
				<button class="button button-outline">Outlined Button</button>
				<input class="button button-clear" type="submit" value="Clear Button">
			</div>
		  </div>
		</div>
		
		<script src="/socket.io.js"></script>
		<script>
			$(function() {
				console.log("Ready");
				
				var socket = io.connect('http://localhost:3090');
				
				socket.on('connect', function(data) {
					console.log("connect");
				});
				
				$('[dog-link]').each(function(i, el) {
					
					var attr = $(el).attr('dog-link');
					
					console.log(i, attr);
					
					//Get initial values
					$.post("/get", { attr: attr }).done(function(json) {
						console.log(attr, json.msg);
						$(el).val(json.msg);
					});
					
					//Functions for updating values
					$(el).keyup(function(field) {
						var val = field.currentTarget.value;
						
						console.log("should set-boy", attr, val);
						
						socket.emit('set-boy', { attr: attr, val: val });
						
						/*$.post("/set", { attr: attr, val: val }).done(function(json) {
							//
						});*/
						
					});
				});
				
				socket.on('set-dog', function(data) {
					$("[dog-link='" + data.attr + "']").val(data.val.toUpperCase());
					
					console.log("set-dog", data);
				});
				
			})
		</script>
	</body>
</html>